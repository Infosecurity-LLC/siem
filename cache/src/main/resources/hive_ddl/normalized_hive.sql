drop table normalized;
CREATE EXTERNAL TABLE normalized (
    id string,
    eventTime bigint,
    category string,
    eventSource_location_fqdn string,
    eventSource_location_host string,
    eventSource_location_hostname string,
    eventSource_location_ip string,
    eventSource_category string,
    eventSource_id string,
    eventSource_subsys string,
    eventSource_title string,
    eventSource_vendor string,
    source_fqdn string,
    source_host string,
    source_hostname string,
    source_ip string,
    source_nat_hostname string,
    source_nat_ip string,
    source_nat_port int,
    source_mac string,
    source_port int,
    source_enrichment_geo_city string,
    source_enrichment_geo_country string,
    source_enrichment_geo_org string,
    source_enrichment_network string,
    source_enrichment_isNetworkLocal boolean,
    destination_fqdn string,
    destination_host string,
    destination_hostname string,
    destination_ip string,
    destination_nat_hostname string,
    destination_nat_ip string,
    destination_nat_port int,
    destination_mac string,
    destination_port int,
    destination_enrichment_geo_city string,
    destination_enrichment_geo_country string,
    destination_enrichment_geo_org string,
    destination_enrichment_network string,
    destination_enrichment_isNetworkLocal boolean,
    interaction_action string,
    interaction_direction string,
    interaction_duration int,
    interaction_importance string,
    interaction_logonType int,
    interaction_protocol string,
    interaction_reason string,
    interaction_startTime bigint,
    interaction_status string,
    subject_category string,
    subject_domain string,
    subject_group string,
    subject_id string,
    subject_name string,
    subject_privileges array<string>,
    subject_version string,
    subject_enrichment_isWorkingDay boolean,
    subject_enrichment_isTimeAllowed boolean,
    subject_enrichment_isHostAccessTimeAllowed boolean,
    subject_enrichment_isObjectAccessAllowed boolean,
    object_category string,
    object_domain string,
    object_group string,
    object_id string,
    object_name string,
    object_path string,
    object_property string,
    object_state string,
    object_value string,
    object_vendor string,
    object_version string,
    collector_location_fqdn string,
    collector_location_host string,
    collector_location_hostname string,
    collector_location_ip string,
    collector_inputId string,
    collector_organization string,
    correlation_eventIds array<string>,
    correlation_count int,
    correlation_name string,
    data_bytesTotal bigint,
    data_bytesIn bigint,
    data_bytesOut bigint,
    data_packetsTotal bigint,
    data_packetsIn bigint,
    data_packetsOut bigint,
    data_aux1 string,
    data_aux2 string,
    data_aux3 string,
    data_aux4 string,
    data_aux5 string,
    data_aux6 string,
    data_aux7 string,
    data_aux8 string,
    data_aux9 string,
    data_aux10 string,
    data_interface string,
    data_msgId string,
    data_originTime bigint,
    data_recvFile array<string>,
    data_tcpFlag array<string>,
    data_time bigint,
    data_rawIds array<string>,
    normalizerVersion int
  )
PARTITIONED BY (sys_org string, sys_year int, sys_month int, sys_day int)
STORED AS ORC
location '/archive/data/';
msck repair table normalized;
